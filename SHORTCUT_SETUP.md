# iOS 快捷指令配置指南

## 步骤 1：创建快捷指令

1. 打开 iOS「快捷指令」App
2. 点击右上角 **+** 创建新指令
3. 命名为「自动记账」

## 步骤 2：添加自动化触发

1. 切换到「自动化」标签
2. 点击「创建个人自动化」
3. 选择「收到通知时」
4. 选择 App：**微信** 或 **支付宝**
5. 点击「下一步」

## 步骤 3：添加操作

### 3.1 获取通知内容
- 添加操作：**获取当前通知的详细信息**
- 选择获取：**内容**

### 3.2 提取金额（正则）
- 添加操作：**匹配文本**
- 模式：`¥(\d+\.?\d*)` 或 `(\d+\.?\d*)元`

### 3.3 提取商家
- 添加操作：**匹配文本**
- 模式：根据通知格式调整，如 `支付给(.+?)，`

### 3.4 打开记账 App
- 添加操作：**打开 URL**
- URL 格式：
```
accounting://add?amount=[金额]&merchant=[商家]&category=餐饮&time=[当前日期]
```

完整示例：
```
accounting://add?amount=35.00&merchant=星巴克&category=餐饮&time=2024-01-15T14:30:00
```

## 步骤 4：测试

1. 关闭「运行前询问」（可选）
2. 保存自动化
3. 用微信或支付宝支付一笔
4. 检查是否自动打开记账 App

## 注意事项

- iOS 17+ 可能需要授权自动化运行
- 微信/支付宝通知格式可能变化，需调整正则
- 首次运行需在快捷指令中允许打开 App

## 手动记账 URL

也可以在 Safari 中测试：
```
accounting://add?amount=100&merchant=测试商家&category=其他
```
